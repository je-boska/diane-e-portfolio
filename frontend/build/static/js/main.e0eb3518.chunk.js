(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{127:function(e,t,n){},128:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},135:function(e,t,n){},136:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(43),o=n.n(c),i=n(8),s=n(2),u=Object(a.createContext)(null),l=JSON.parse(sessionStorage.getItem("user")),p=function(e,t){return null===t?(sessionStorage.removeItem("user"),null):Object(s.a)(Object(s.a)({},e),t)},m=function(e){var t=Object(a.useReducer)(p,l||null),n=Object(i.a)(t,2),c=n[0],o=n[1];return Object(a.useEffect)((function(){sessionStorage.setItem("user",JSON.stringify(c))}),[c]),r.a.createElement(u.Provider,{value:{user:c,setUser:o}},e.children)},f=n(17),d=n(5),b=n(1),h=n.n(b),g=n(4),v=(n(53),n(7)),E=n.n(v),O=(n(71),n(44)),j=new(n.n(O).a),x=function(e){var t=e.post,n=e.layout;return r.a.createElement(r.a.Fragment,null,t.sections.map((function(e){return r.a.createElement("section",{key:e.sectionId,className:"section ".concat(n)},e.image&&r.a.createElement("img",{src:e.image,alt:e.title}),e.title||e.text?r.a.createElement("div",{className:"centered-text"},e.title?r.a.createElement("h1",{style:{fontFamily:e.font}},e.title):null,e.text?r.a.createElement("div",{dangerouslySetInnerHTML:{__html:j.render(e.text)}}):null):null)})))},w=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){(function(){var e=Object(g.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("/api/posts");case 2:t=e.sent,n=t.data,c(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),r.a.createElement(r.a.Fragment,null,n.sort((function(e,t){return e.position>t.position?-1:1})).map((function(e){return r.a.createElement("section",{key:e._id,className:"post"},1===e.sections.length?r.a.createElement(x,{post:e,layout:"one-layout"}):2===e.sections.length?r.a.createElement(x,{post:e,layout:"two-layout"}):3===e.sections.length?r.a.createElement(x,{post:e,layout:"three-layout"}):4===e.sections.length?r.a.createElement(x,{post:e,layout:"four-layout"}):null)})))};n(127);function y(e){return k.apply(this,arguments)}function k(){return(k=Object(g.a)(h.a.mark((function e(t){var n,a,r,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("/api/posts/".concat(t));case 2:return n=e.sent,a=n.data,r=a.sections,c=a.position,e.abrupt("return",{sections:r,position:c});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t){return C.apply(this,arguments)}function C(){return(C=Object(g.a)(h.a.mark((function e(t,n){var a,r,c,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("image",t),r={"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(n)},e.next=5,E.a.post("/api/upload",a,{headers:r});case 5:return c=e.sent,o=c.data,e.abrupt("return",o.data);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t,n){return N.apply(this,arguments)}function N(){return(N=Object(g.a)(h.a.mark((function e(t,n,a){var r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},e.next=3,E.a.put("/api/posts/".concat(t),a,{headers:r});case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t){var n=e.slice(-24,-4);E.a.delete("/api/upload/".concat(n),{headers:{Authorization:"Bearer ".concat(t)}})}function T(e,t){return L.apply(this,arguments)}function L(){return(L=Object(g.a)(h.a.mark((function e(t,n){var a,r,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(n);case 2:for(a=e.sent,r=[],c=0;c<a.sections.length;c++)r.push(a.sections[c].image);if(!r.includes(t)){e.next=9;break}return e.abrupt("return",!0);case 9:return e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,n,a,r){return A.apply(this,arguments)}function A(){return(A=Object(g.a)(h.a.mark((function e(t,n,a,r,c){var o,i,s,u,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=new URLSearchParams(t),!o.get("create")){e.next=10;break}return i={Authorization:"Bearer ".concat(n)},e.next=6,E.a.delete("/api/posts/".concat(a),{headers:i});case 6:for(s=0;s<r.length;s++)r[s].image&&P(r[s].image,n);c&&P(c,n),e.next=24;break;case 10:u=0;case 11:if(!(u<r.length)){e.next=20;break}if(!r[u].image){e.next=17;break}return e.next=15,T(r[u].image,a);case 15:e.sent||P(r[u].image,n);case 17:u++,e.next=11;break;case 20:return e.next=22,T(c,a);case 22:l=e.sent,c&&!l&&P(c,n);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e){return _.apply(this,arguments)}function _(){return(_=Object(g.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("/api/posts",{},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});case 2:return n=e.sent,a=n.data._id,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e,t){return U.apply(this,arguments)}function U(){return(U=Object(g.a)(h.a.mark((function e(t,n){var a,r,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("/api/posts/".concat(n));case 2:for(a=e.sent,r=a.data.sections,c=0;c<r.length;c++)r[c].image&&P(r[c].image,t);return e.next=7,E.a.delete("/api/posts/".concat(n),{headers:{Authorization:"Bearer ".concat(t)}});case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(){return G.apply(this,arguments)}function G(){return(G=Object(g.a)(h.a.mark((function e(){var t,n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("/api/posts");case 2:return t=e.sent,n=t.data,a=n.sort((function(e,t){return e.position<t.position?1:-1})),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n(128);var M=function(e){var t=e.section,n=e.changeSection,a=e.deleteSectionHandler,c=e.editing,o=e.editPostScreen,i=t.font,s=t.title,u=t.text,l=t.image,p=t.sectionId;return r.a.createElement("div",{className:"section-preview ".concat(c?"editing":"not-editing"),onClick:function(){o&&n(i,s,u,l,p)},style:o&&{cursor:"pointer"}},l&&r.a.createElement("img",{src:l,alt:s}),s?r.a.createElement("div",{className:"preview-title-text"},r.a.createElement("h5",{style:{fontFamily:i}},s)):u?r.a.createElement("div",{className:"preview-title-text"},r.a.createElement("p",null,u)):null,o&&c&&r.a.createElement("button",{className:"delete-section-button",onClick:a},r.a.createElement("h3",null,"-")))},R=function(e){var t=e.history,n=Object(a.useState)([]),c=Object(i.a)(n,2),o=c[0],l=c[1],p=Object(a.useState)(!1),m=Object(i.a)(p,2),d=m[0],b=m[1],v=Object(a.useContext)(u),E=v.user,O=v.setUser,j=Object(a.useCallback)(Object(g.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z();case 2:t=e.sent,l(t);case 4:case"end":return e.stop()}}),e)}))),[]);function x(){return(x=Object(g.a)(h.a.mark((function e(t,n){var a,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b(!0),!window.confirm("Are you sure?")){e.next=4;break}return e.next=4,B(E.token,t);case 4:for(a=o.filter((function(e){return e.position!==n})).map((function(e){return Object(s.a)(Object(s.a)({},e),{},{position:e.position>n?e.position-1:e.position})})),r=0;r<a.length;r++)a[r].position>=n&&I(a[r]._id,E.token,a[r]);l(a),b(!1);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return(w=Object(g.a)(h.a.mark((function e(){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(E.token);case 2:n=e.sent,t.push("/admin/edit/".concat(n,"?create=true"));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){E?j():t.push("/login")}),[E,t,j]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"admin-buttons"},r.a.createElement("button",{onClick:function(){return w.apply(this,arguments)},className:"create-post-button"},r.a.createElement("h3",null,"CREATE POST")),r.a.createElement("button",{onClick:function(){O(null),sessionStorage.removeItem("user")},className:"logout-button"},r.a.createElement("h3",null,"LOG OUT"))),o.sort((function(e,t){return e.position<t.position?1:-1})).map((function(e){return r.a.createElement("div",{className:"post-card",key:e._id},r.a.createElement("div",{className:"up-down-arrows"},r.a.createElement("button",{onClick:function(){return function(e){for(var t=o.map((function(t){return Object(s.a)(Object(s.a)({},t),{},{position:t.position===e&&t.position<o.length?t.position+1:t.position===e+1?e:t.position})})),n=0;n<t.length;n++)t[n].position!==e&&t[n].position!==e+1||I(t[n]._id,E.token,t[n]);l(t)}(e.position)}},r.a.createElement("h3",null,"\u2191")),r.a.createElement("button",{onClick:function(){return function(e){for(var t=o.map((function(t){return Object(s.a)(Object(s.a)({},t),{},{position:t.position===e&&t.position>1?t.position-1:t.position===e-1?t.position+1:t.position})})),n=0;n<t.length;n++)t[n].position!==e&&t[n].position!==e-1||I(t[n]._id,E.token,t[n]);l(t)}(e.position)}},r.a.createElement("h3",null,"\u2193"))),r.a.createElement("div",{className:"section-previews"},e.sections.map((function(e){return r.a.createElement(M,{key:e.sectionId,section:e})}))),r.a.createElement("div",{className:"delete-edit-buttons"},r.a.createElement("button",{className:"delete-button",onClick:function(){return function(e,t){return x.apply(this,arguments)}(e._id,e.position)},disabled:d},r.a.createElement("h3",null,"DELETE")),r.a.createElement(f.b,{to:"/admin/edit/".concat(e._id)},r.a.createElement("button",{className:"edit-button"},r.a.createElement("h3",null,"EDIT")))))})))},H=(n(133),{sections:[{sectionId:0}],sectionId:"",font:"backout",title:"",text:"",image:"",loading:!1,sectionSaved:!1,imageCleanupPublish:[],position:0,postsLength:0});var J=n(46),q=function(e){var t=e.sections,n=e.setSections,a=e.font,c=e.setFont,o=e.title,i=e.setTitle,s=e.text,u=e.setText,l=e.image,p=e.setImage,m=e.sectionId,f=e.setSectionId,d=e.loading,b=e.setLoading,v=e.token,E=e.setSectionSaved,O=e.imageCleanupPublish,j=e.setImageCleanupPublish,x=function(){var e=Object(g.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l&&!m?P(l,v):l&&m&&j(O.concat(l)),b(!0),e.next=4,S(t.target.files[0],v);case 4:n=e.sent,p(n),b(!1),E(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),m){var r=t.findIndex((function(e){return e.sectionId===m})),d=t;d[r]={sectionId:m,font:a,title:o,text:s,image:l},n(d)}else{if(!(t.length<4))return void alert("Post is already full");n([].concat(Object(J.a)(t),[{sectionId:Math.random().toString(36).substring(2,9),font:a,title:o,text:s,image:l}]))}c("Georgia"),i(""),u(""),p(""),f(""),E(!0)}},r.a.createElement("button",{className:"save-button",type:"submit",disabled:d},r.a.createElement("h3",null,"SAVE")),r.a.createElement("br",null),r.a.createElement("select",{name:"font-select",className:"font-select",value:a,onChange:function(e){c(e.target.value),E(!1)}},r.a.createElement("option",{value:"backout"},"BackOut"),r.a.createElement("option",{value:"cirrus-cumulus"},"Cirrus Cumulus"),r.a.createElement("option",{value:"cantiquenormal"},"Cantique-Normal")),r.a.createElement("br",null),r.a.createElement("input",{name:"title",size:"50",id:"title",placeholder:"Title",value:o,onChange:function(e){i(e.target.value),E(!1)}}),r.a.createElement("br",null),r.a.createElement("textarea",{name:"text",rows:"10",cols:"50",id:"text",placeholder:"Text",value:s,onChange:function(e){u(e.target.value),E(!1)}}),r.a.createElement("br",null),l&&!d&&r.a.createElement("button",{onClick:function(e){e.preventDefault(),m?j(O.concat(l)):P(l,v),p("")}},r.a.createElement("h3",null,"- REMOVE IMAGE")),l&&!d&&r.a.createElement("div",{className:"image-preview"},r.a.createElement("img",{src:l,alt:o})),r.a.createElement("div",{className:"image-upload-container"},r.a.createElement("label",{className:"image-upload-btn"},d?"UPLOADING":l||"Choose image file",r.a.createElement("input",{type:"file",accept:"image/png, image/jpg, image/jpeg",onChange:x})))))},V=function(e){var t=e.match,n=e.history,c=Object(a.useContext)(u).user,o=function(){var e=Object(a.useState)(H),t=Object(i.a)(e,2),n=t[0],r=t[1];function c(){return(c=Object(g.a)(h.a.mark((function e(t){var n,a,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:n=e.sent,a=n.sections,c=n.position,r((function(e){return Object(s.a)(Object(s.a)({},e),{},{sections:a,position:c})}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function o(){return(o=Object(g.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z();case 2:t=e.sent,r((function(e){return Object(s.a)(Object(s.a)({},e),{},{postsLength:t.length})}));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{values:n,setSections:function(e){r((function(t){return Object(s.a)(Object(s.a)({},t),{},{sections:e})}))},setFont:function(e){r((function(t){return Object(s.a)(Object(s.a)({},t),{},{font:e})}))},setTitle:function(e){r((function(t){return Object(s.a)(Object(s.a)({},t),{},{title:e})}))},setText:function(e){r((function(t){return Object(s.a)(Object(s.a)({},t),{},{text:e})}))},setImage:function(e){r((function(t){return Object(s.a)(Object(s.a)({},t),{},{image:e})}))},setSectionId:function(e){r((function(t){return Object(s.a)(Object(s.a)({},t),{},{sectionId:e})}))},setLoading:function(e){r((function(t){return Object(s.a)(Object(s.a)({},t),{},{loading:e})}))},setSectionSaved:function(e){r((function(t){return Object(s.a)(Object(s.a)({},t),{},{sectionSaved:e})}))},setImageCleanupPublish:function(e){r((function(t){return Object(s.a)(Object(s.a)({},t),{},{imageCleanupPublish:e})}))},getPost:function(e){return c.apply(this,arguments)},getPostsLength:function(){return o.apply(this,arguments)}}}(),l=o.values,p=o.setSections,m=o.setFont,f=o.setTitle,d=o.setText,b=o.setImage,v=o.setSectionId,E=o.setLoading,O=o.setSectionSaved,j=o.setImageCleanupPublish,x=o.getPost,w=o.getPostsLength,k=l.sections,S=l.position,C=l.font,N=l.title,L=l.text,A=l.image,D=l.sectionId,_=l.loading,B=l.sectionSaved,U=l.imageCleanupPublish,G=l.postsLength;function R(){return new URLSearchParams(window.location.search).get("create")}Object(a.useEffect)((function(){x(t.params.id),w()}),[]),Object(a.useEffect)((function(){c||n.push("/login")}),[c,n]);var J=function(){var e=Object(g.a)(h.a.mark((function e(a){var r,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a.preventDefault(),r=R(),o=0;o<U.length;o++)P(U[o],c.token);return e.next=5,I(t.params.id,c.token,{sections:k,position:r?G:S});case 5:n.push("/admin");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=Object(g.a)(h.a.mark((function e(a){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),E(!0),e.next=4,F(window.location.search,c.token,t.params.id,k,A);case 4:n.push("/admin");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(g.a)(h.a.mark((function e(n,a,r,o,i){var s,u,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=R(),!A||s||B){e.next=8;break}return e.next=4,T(A,t.params.id);case 4:e.sent||P(A,c.token),e.next=9;break;case 8:if(s&&!B&&A){for(u=!1,l=0;l<k.length;l++)A===k[l].image&&(u=!0);u||P(A,c.token)}case 9:m(n),f(a),d(r),b(o),v(i);case 14:case"end":return e.stop()}}),e)})));return function(t,n,a,r,c){return e.apply(this,arguments)}}();function Q(e){if(e.preventDefault(),D){var t=k.find((function(e){return e.sectionId===D})).image;t&&j(U.concat(t));var n=k.filter((function(e){return e.sectionId!==D}));p(n),v(""),f(""),d(""),b(""),O(!0)}}return r.a.createElement("div",{className:"form-container"},r.a.createElement("div",{className:"cancel-publish-buttons"},r.a.createElement("button",{className:"cancel-button",onClick:V,disabled:_},r.a.createElement("h3",null,"CANCEL")),r.a.createElement("button",{className:"publish-button",onClick:J,disabled:_||!B},r.a.createElement("h3",null,"PUBLISH"))),r.a.createElement("div",{className:"section-previews"},k.map((function(e){return r.a.createElement(M,{key:e.sectionId,changeSection:K,deleteSectionHandler:Q,section:e,sections:k,editPostScreen:!0,editing:e.sectionId===D})})),k.length<4&&r.a.createElement("button",{onClick:function(e){e.preventDefault(),!D&&A&&P(A,c.token),v(""),f(""),d(""),b(""),O(!1)},className:"add-section-button"},r.a.createElement("h3",null,"+"))),r.a.createElement(q,{sections:k,font:C,setFont:m,title:N,setTitle:f,text:L,setText:d,image:A,setImage:b,sectionId:D,setSectionId:v,loading:_,setLoading:E,setSections:p,sectionSaved:B,setSectionSaved:O,imageCleanupPublish:U,setImageCleanupPublish:j,token:c.token}))};n(134);function K(e,t){return Q.apply(this,arguments)}function Q(){return(Q=Object(g.a)(h.a.mark((function e(t,n){var a,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.post("/api/users/login",{email:t,password:n},{headers:{"Content-Type":"application/json"}});case 2:return a=e.sent,r=a.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W=function(e){var t=e.history,n=Object(a.useState)(""),c=Object(i.a)(n,2),o=c[0],s=c[1],l=Object(a.useState)(""),p=Object(i.a)(l,2),m=p[0],f=p[1],d=Object(a.useState)(!1),b=Object(i.a)(d,2),v=b[0],E=b[1],O=Object(a.useState)(!1),j=Object(i.a)(O,2),x=j[0],w=j[1],y=Object(a.useContext)(u),k=y.user,S=y.setUser,C=function(){var e=Object(g.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),E(!0),e.prev=2,e.next=5,K(o,m);case 5:n=e.sent,sessionStorage.setItem("user",n),S(n),E(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),w(!0),E(!1);case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){k&&t.push("/admin")}),[t,k]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"form-container"},r.a.createElement("form",{onSubmit:C},r.a.createElement("label",{htmlFor:"email"},r.a.createElement("h2",null,"Email")),r.a.createElement("input",{name:"email",id:"email",value:o,onChange:function(e){return s(e.target.value)}}),r.a.createElement("label",{htmlFor:"password"},r.a.createElement("h2",null,"Password")),r.a.createElement("input",{name:"password",id:"password",type:"password",value:m,onChange:function(e){return f(e.target.value)}}),r.a.createElement("br",null),x&&r.a.createElement("h3",{className:"error"},"Invalid email or password"),r.a.createElement("br",null),r.a.createElement("button",{className:"login-button",type:"submit",disabled:v},r.a.createElement("h3",null,"LOG IN")))))};n(135);var X=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,null,r.a.createElement(d.a,{path:"/",component:w,exact:!0}),r.a.createElement(m,null,r.a.createElement(d.a,{path:"/login",component:W}),r.a.createElement(d.a,{path:"/admin",component:R,exact:!0}),r.a.createElement(d.a,{path:"/admin/edit/:id",component:V}))))};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(X,null)),document.getElementById("root"))},47:function(e,t,n){e.exports=n(136)},53:function(e,t,n){},71:function(e,t,n){}},[[47,1,2]]]);
//# sourceMappingURL=main.e0eb3518.chunk.js.map